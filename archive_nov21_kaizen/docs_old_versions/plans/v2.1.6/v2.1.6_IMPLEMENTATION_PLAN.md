# v2.1.6 Implementation Plan - Foundation & Polish

**Target**: Week of Nov 18-22, 2025  
**Duration**: 4-5 days  
**Theme**: Config System, Embedding UX, Testing Excellence

---

## Priority 1: Config File System (1.5 days)

**Goal**: `~/.whitemagic/config.yaml` as single source of truth

### Tasks
1. Create `whitemagic/config/schema.py` - Pydantic models for config
2. Create `whitemagic/config/manager.py` - Load/save config
3. Add CLI commands: `wm config get/set/show`
4. Update embeddings/terminal to read config
5. Write tests for config system

### Files
- `whitemagic/config/*.py` (new)
- `whitemagic/cli_app.py` (add config commands)
- `tests/test_config.py` (new)

---

## Priority 2: Bundled Embeddings (1 day)

**Goal**: Zero-friction embedding installation

### Tasks
1. Add `wm embeddings install` command with progress bar
2. Add `wm setup-embeddings` interactive wizard
3. Auto-download on first use with caching
4. Update docs with setup instructions

### Files
- `whitemagic/cli_app.py` (add embeddings commands)
- `whitemagic/embeddings/local_provider.py` (add download progress)
- `requirements.txt` (ensure `rich` included)

---

## Priority 3: Async CLI & Polish (1 day)

**Goal**: Non-blocking CLI operations

### Tasks
1. Add async wrappers for long-running commands
2. Add progress indicators (spinners, bars)
3. Improve `search-semantic` with rich output
4. Add `--json` flag to all commands

### Files
- `whitemagic/cli_app.py` (async decorators, rich formatting)

---

## Priority 4: Test Coverage 100% (1 day)

**Goal**: Fix remaining 2 tests, achieve 160/160

### Tasks
1. Fix or skip 2 Whop integration tests
2. Add missing config tests
3. Add embeddings install tests
4. Run full regression suite

---

## Priority 5: Documentation (0.5 days)

### Updates Needed
- README.md - Add config section
- New: docs/CONFIG_GUIDE.md
- Update: docs/guides/QUICKSTART.md
- CHANGELOG.md - v2.1.6 entry

---

## Success Criteria

**User Experience**:
- ✅ Install → semantic search in <5 commands
- ✅ No manual torch installation
- ✅ One config file for everything

**Technical**:
- ✅ 160/160 tests passing
- ✅ Config read by CLI/SDK/API
- ✅ Embeddings install <2 min

---

## Timeline

**Day 1**: Config system  
**Day 2**: Config integration + embeddings install  
**Day 3**: Async CLI + polish  
**Day 4**: Testing + fix remaining issues  
**Day 5**: Documentation + release

---

## Release Checklist

- [ ] Config file working
- [ ] `wm config` commands functional
- [ ] `wm embeddings install` working
- [ ] `wm setup-embeddings` wizard complete
- [ ] All tests passing (160/160)
- [ ] Documentation updated
- [ ] CHANGELOG.md updated
- [ ] Git tag v2.1.6
- [ ] Push to GitHub
- [ ] Verify Railway deployment
