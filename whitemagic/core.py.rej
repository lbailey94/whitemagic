--- whitemagic/core.py
+++ whitemagic/core.py
@@ -8,6 +8,7 @@
 from typing import Any, Dict, List, Optional, Sequence, Tuple
 
 from .models import ConsolidationEntry
+from .utils.file_lock import file_lock, atomic_write
 
 
 # Constants
@@ -251,8 +252,9 @@
         self.metadata["memory_index"] = serialised_entries
 
         # Write to file
-        with open(self.metadata_file, "w", encoding="utf-8") as handle:
-            json.dump(self.metadata, handle, indent=2)
+        with file_lock(self.metadata_file):
+            content = json.dumps(self.metadata, indent=2)
+            atomic_write(self.metadata_file, content)
 
 
 
